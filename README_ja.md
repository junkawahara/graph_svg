# DrawSVG

TypeScript で構築された SVG ドローエディタ。Electron デスクトップアプリとしても、Web ブラウザアプリとしても利用できます。

**[オンラインで試す](https://junkawahara.github.io/graph_svg/)** | **[English README](README.md)**

## 機能

### 描画ツール

- **直線** - 矢印マーカー付きの直線
- **楕円** - 楕円・円
- **長方形** - 長方形・正方形
- **多角形** - 正多角形・不規則多角形
- **ポリライン** - 折れ線（開いた線分の連結）
- **パス** - ベジェ曲線と複雑なパス（3次/2次ベジェ、円弧）
- **テキスト** - リッチテキスト対応（太字、イタリック、下線、取消線、上付き、下付き、文字色）
- **画像** - 埋め込み画像（Electron版のみ）

### グラフ描画

- **ノード** - グラフの頂点を配置（楕円＋ラベル）
- **エッジ** - ノード間を有向/無向の辺で接続
- 並行辺の自動カーブオフセット
- 自己ループ
- グラフファイルのインポート/エクスポート（Edge List形式、DIMACS形式）
- 自動レイアウト（Cytoscape.js を使用）

### 矢印マーカー

直線とパスに設定可能:

| 形状 | 説明 |
|------|------|
| Arrow | 開いた矢印（>） |
| Triangle | 塗りつぶし三角形 |
| Circle | 塗りつぶし円 |
| Diamond | 塗りつぶしひし形 |

各形状に3サイズ（Small, Medium, Large）。マーカーの色はストロークの色に連動します。

### 編集操作

- **選択** - クリック、Shift+クリック（追加選択）、ドラッグで範囲選択
- **移動** - 選択した図形をドラッグ
- **リサイズ** - コーナーハンドルで変形。Ctrl+ドラッグで縦横比を固定
- **回転** - 図形を中心点の周りで回転
- **グループ化/解除** - 複数図形をグループ化。ネスト対応
- **重ね順変更** - 前面へ、背面へ、最前面へ、最背面へ
- **コピー/ペースト** - 図形のクリップボード操作
- **元に戻す/やり直し** - すべての編集操作に対応した履歴管理

### スタイルプロパティ

- 塗りつぶし色（なし/透明も可）
- 線の色
- 線の幅
- 不透明度
- 線の破線パターン
- 線端のスタイル

### ズーム・パン

- マウスホイールでズーム（カーソル位置中心）
- Space+ドラッグ または パンツールでパン
- ズーム範囲: 10% ～ 1000%
- ツールバーのボタンまたは Ctrl+0 で100%にリセット

### グリッドスナップ

- ツールバーのボタンまたは `G` キーでスナップ切り替え
- スナップ間隔: 10px
- 図形の作成・移動・リサイズ時に適用

### Fit to Content

- **Export Fit to Content** - コンテンツ範囲にトリミングしたSVGをエクスポート（余白サイズは設定可能）
- **Fit Canvas to Content** - キャンバスサイズを全図形にフィット（Undo対応）

### ファイル操作

- 新規作成、開く、保存、名前を付けて保存
- SVG ファイル形式（完全な読み書き対応）
- 外部 SVG ファイルのインポート（PowerPoint、Illustrator 等から出力されたもの）
- グラフファイルのインポート/エクスポート（Edge List形式、DIMACS形式）

## はじめに

### 前提条件

- [Node.js](https://nodejs.org/)（v18以降を推奨）

### インストール

```bash
git clone <repository-url>
cd drawsvg
npm install
```

### 起動（Electron デスクトップアプリ）

```bash
npm start
```

### 起動（Web ブラウザアプリ）

```bash
npm run start:web
```

ターミナルに表示される URL（通常 `http://localhost:3000`）をブラウザで開いてください。

### 開発モード

```bash
# Electron（ウォッチモード）
npm run dev

# Web（ウォッチモード）
npm run dev:web
```

### テスト実行

```bash
npm test
```

## プラットフォーム間の機能差異

| 機能 | Electron版 | Web版 |
|------|-----------|-------|
| ファイル保存 | 上書き保存可能 | ダウンロードのみ |
| ファイルパス | フルパスをタイトルバーに表示 | ファイル名のみ |
| 画像インポート | 対応 | 未対応 |
| 終了確認 | カスタムダイアログ | ブラウザ標準 |
| メニューバー | OS ネイティブメニュー | Web メニューバー |
| 設定の保存先 | electron-store | localStorage |

## キーボードショートカット

### ツール

| キー | ツール |
|------|--------|
| `V` | 選択 |
| `L` | 直線 |
| `E` | 楕円 |
| `R` | 長方形 |
| `5` | 多角形 |
| `Y` | ポリライン |
| `P` | パス |
| `T` | テキスト |
| `N` | ノード（グラフ） |
| `W` | エッジ（グラフ） |
| `H` | パン |
| `Z` | ズーム |
| `O` | 回転 |

### 編集

| ショートカット | 操作 |
|--------------|------|
| `Delete` / `Backspace` | 選択図形を削除 |
| `Ctrl+Z` | 元に戻す |
| `Ctrl+Y` / `Ctrl+Shift+Z` | やり直し |
| `Ctrl+C` | コピー |
| `Ctrl+V` | ペースト |
| `Ctrl+G` | グループ化 |
| `Ctrl+Shift+G` | グループ解除 |
| `Ctrl+]` | 1つ前面へ |
| `Ctrl+[` | 1つ背面へ |
| `Ctrl+Shift+]` | 最前面へ |
| `Ctrl+Shift+[` | 最背面へ |

### ファイル

| ショートカット | 操作 |
|--------------|------|
| `Ctrl+N` | 新規作成 |
| `Ctrl+S` | 保存 |
| `Ctrl+Shift+S` | 名前を付けて保存 |
| `Ctrl+O` | ファイルを開く |

### その他

| ショートカット | 操作 |
|--------------|------|
| `G` | グリッドスナップ切り替え |
| `Ctrl+0` | ズームを100%にリセット |

## マウス操作

### 選択

| 操作 | 動作 |
|------|------|
| クリック | 図形を選択 |
| Shift+クリック | 選択に追加 |
| ドラッグ（空白から） | 範囲選択（完全包含） |
| Alt+ドラッグ | 範囲選択（交差モード） |
| Shift+ドラッグ | 既存選択に追加 |

### リサイズ

| 操作 | 動作 |
|------|------|
| コーナーハンドルをドラッグ | 自由リサイズ |
| Ctrl+ドラッグ | 縦横比を固定 |
| Alt+ドラッグ（グループのみ） | 位置関係のみスケール（子要素のサイズは維持） |

### パス描画

| 操作 | 動作 |
|------|------|
| クリック | 直線ポイントを追加 |
| Shift+クリック | 3次ベジェポイントを追加 |
| 開始点付近をクリック | パスを閉じる |
| ダブルクリック / Enter | 開いたパスとして完成 |
| Escape | キャンセル |

## SVG ファイル形式

DrawSVG は標準的な SVG ファイルとして保存します。矢印マーカー、グラフのノード/エッジ、グループなどの特殊な機能は `data-*` 属性にメタデータとして保存されます。これにより他の SVG ビューアとの互換性を保ちつつ、DrawSVG での再読み込み時に情報を復元できます。

## ライセンス

MIT
