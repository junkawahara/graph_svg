<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
  <title>DrawSVG</title>
</head>
<body>
  <div id="app">
    <!-- Toolbar -->
    <div id="toolbar">
      <div class="tool-group">
        <button id="tool-select" class="tool-btn active" title="Select (V)">
          <span class="icon">&#9654;</span>
        </button>
        <button id="tool-pan" class="tool-btn" title="Pan (H)">
          <span class="icon">&#9995;</span>
        </button>
        <button id="tool-zoom" class="tool-btn" title="Zoom (Z)">
          <span class="icon">&#128269;</span>
        </button>
        <button id="tool-line" class="tool-btn" title="Line (L)">
          <span class="icon">&#9135;</span>
        </button>
        <button id="tool-ellipse" class="tool-btn" title="Ellipse (E)">
          <span class="icon">&#9711;</span>
        </button>
        <button id="tool-rectangle" class="tool-btn" title="Rectangle (R)">
          <span class="icon">&#9645;</span>
        </button>
        <button id="tool-polygon" class="tool-btn" title="Polygon (P)">
          <span class="icon">&#11039;</span>
        </button>
        <button id="tool-polyline" class="tool-btn" title="Polyline (Y)">
          <span class="icon">&#10138;</span>
        </button>
        <button id="tool-bezier" class="tool-btn" title="Bezier Path (B)">
          <span class="icon">&#8766;</span>
        </button>
        <button id="tool-text" class="tool-btn" title="Text (T)">
          <span class="icon">T</span>
        </button>
        <button id="tool-node" class="tool-btn" title="Node (N)">
          <span class="icon">&#9673;</span>
        </button>
        <button id="tool-edge" class="tool-btn" title="Edge (W)">
          <span class="icon">&#8594;</span>
        </button>
        <button id="tool-delete-node" class="tool-btn" title="Delete Node">
          <span class="icon">&#9673;&#10005;</span>
        </button>
        <button id="tool-delete-edge" class="tool-btn" title="Delete Edge">
          <span class="icon">&#8594;&#10005;</span>
        </button>
        <button id="tool-rotate" class="tool-btn" title="Rotate (O)">
          <span class="icon">&#8634;</span>
        </button>
      </div>
      <div class="tool-group">
        <button id="btn-undo" class="tool-btn" title="Undo (Ctrl+Z)" disabled>
          <span class="icon">&#8630;</span>
        </button>
        <button id="btn-redo" class="tool-btn" title="Redo (Ctrl+Y)" disabled>
          <span class="icon">&#8631;</span>
        </button>
      </div>
      <div class="tool-group">
        <button id="btn-delete" class="tool-btn" title="Delete (Del)" disabled>
          <span class="icon">&#128465;</span>
        </button>
      </div>
      <div class="tool-group">
        <button id="btn-bring-front" class="tool-btn" title="Bring to Front (Ctrl+Shift+])" disabled>
          <span class="icon">&#8648;</span>
        </button>
        <button id="btn-bring-forward" class="tool-btn" title="Bring Forward (Ctrl+])" disabled>
          <span class="icon">&#8593;</span>
        </button>
        <button id="btn-send-backward" class="tool-btn" title="Send Backward (Ctrl+[)" disabled>
          <span class="icon">&#8595;</span>
        </button>
        <button id="btn-send-back" class="tool-btn" title="Send to Back (Ctrl+Shift+[)" disabled>
          <span class="icon">&#8650;</span>
        </button>
      </div>
      <div class="tool-group">
        <button id="btn-snap" class="tool-btn" title="Snap to Grid (G)">
          <span class="icon">#</span>
        </button>
        <button id="btn-directed" class="tool-btn" title="Toggle Directed Edge">
          <span class="icon">―</span>
        </button>
        <button id="btn-auto-layout" class="tool-btn" title="Auto Layout">
          <span class="icon">&#9635;</span>
        </button>
      </div>
      <div class="tool-group">
        <span id="zoom-indicator" class="zoom-indicator" title="Current zoom level">100%</span>
        <button id="btn-zoom-reset" class="tool-btn" title="Reset Zoom (Ctrl+0)">1:1</button>
      </div>
      <div class="tool-group right">
        <button id="btn-new" class="tool-btn" title="New (Ctrl+N)">New</button>
        <button id="btn-open" class="tool-btn" title="Open (Ctrl+O)">Open</button>
        <button id="btn-save" class="tool-btn" title="Save (Ctrl+S)">Save</button>
        <button id="btn-save-as" class="tool-btn" title="Save As (Ctrl+Shift+S)">Save As</button>
      </div>
    </div>

    <!-- Main content area -->
    <div id="main-content">
      <!-- Canvas -->
      <div id="canvas-container">
        <svg id="canvas" xmlns="http://www.w3.org/2000/svg">
          <!-- SVG shapes will be rendered here -->
        </svg>
      </div>

      <!-- Sidebar -->
      <div id="sidebar">
        <h3>Properties</h3>

        <!-- Style Class selector (shown when shapes are selected) -->
        <div id="style-class-section" class="property-section" style="display: none;">
          <label class="section-label">Style Class</label>
          <div class="class-selector">
            <select id="prop-style-class">
              <option value="">(none)</option>
            </select>
            <button id="btn-save-class" class="class-btn" title="Save current style as new class">+</button>
            <button id="btn-manage-classes" class="class-btn" title="Manage style classes">⚙</button>
          </div>
        </div>

        <!-- Default Node Size (shown when node tool is active) -->
        <div id="default-node-size-section" class="property-section" style="display: none;">
          <label class="section-label">Default Node Size</label>
          <div class="property-row">
            <div class="property-group small">
              <label>RX</label>
              <input type="number" id="prop-default-node-rx" step="1" min="5" value="20">
            </div>
            <div class="property-group small">
              <label>RY</label>
              <input type="number" id="prop-default-node-ry" step="1" min="5" value="20">
            </div>
          </div>
        </div>

        <!-- Position/Size properties (hidden by default) -->
        <!-- Line position -->
        <div id="line-position" class="position-section" style="display: none;">
          <div class="property-row">
            <div class="property-group small">
              <label>X1</label>
              <input type="number" id="prop-line-x1" step="any">
            </div>
            <div class="property-group small">
              <label>Y1</label>
              <input type="number" id="prop-line-y1" step="any">
            </div>
          </div>
          <div class="property-row">
            <div class="property-group small">
              <label>X2</label>
              <input type="number" id="prop-line-x2" step="any">
            </div>
            <div class="property-group small">
              <label>Y2</label>
              <input type="number" id="prop-line-y2" step="any">
            </div>
          </div>
        </div>

        <!-- Ellipse position -->
        <div id="ellipse-position" class="position-section" style="display: none;">
          <div class="property-row">
            <div class="property-group small">
              <label>CX</label>
              <input type="number" id="prop-ellipse-cx" step="any">
            </div>
            <div class="property-group small">
              <label>CY</label>
              <input type="number" id="prop-ellipse-cy" step="any">
            </div>
          </div>
          <div class="property-row">
            <div class="property-group small">
              <label>RX</label>
              <input type="number" id="prop-ellipse-rx" step="any" min="1">
            </div>
            <div class="property-group small">
              <label>RY</label>
              <input type="number" id="prop-ellipse-ry" step="any" min="1">
            </div>
          </div>
        </div>

        <!-- Rectangle position -->
        <div id="rectangle-position" class="position-section" style="display: none;">
          <div class="property-row">
            <div class="property-group small">
              <label>X</label>
              <input type="number" id="prop-rect-x" step="any">
            </div>
            <div class="property-group small">
              <label>Y</label>
              <input type="number" id="prop-rect-y" step="any">
            </div>
          </div>
          <div class="property-row">
            <div class="property-group small">
              <label>W</label>
              <input type="number" id="prop-rect-width" step="any" min="1">
            </div>
            <div class="property-group small">
              <label>H</label>
              <input type="number" id="prop-rect-height" step="any" min="1">
            </div>
          </div>
        </div>

        <!-- Text position -->
        <div id="text-position" class="position-section" style="display: none;">
          <div class="property-row">
            <div class="property-group small">
              <label>X</label>
              <input type="number" id="prop-text-x" step="any">
            </div>
            <div class="property-group small">
              <label>Y</label>
              <input type="number" id="prop-text-y" step="any">
            </div>
          </div>
        </div>

        <!-- Node position -->
        <div id="node-position" class="position-section" style="display: none;">
          <div class="property-row">
            <div class="property-group small">
              <label>CX</label>
              <input type="number" id="prop-node-cx" step="any">
            </div>
            <div class="property-group small">
              <label>CY</label>
              <input type="number" id="prop-node-cy" step="any">
            </div>
          </div>
          <div class="property-row">
            <div class="property-group small">
              <label>RX</label>
              <input type="number" id="prop-node-rx" step="any" min="1">
            </div>
            <div class="property-group small">
              <label>RY</label>
              <input type="number" id="prop-node-ry" step="any" min="1">
            </div>
          </div>
        </div>

        <!-- Text-specific properties (hidden by default) -->
        <div id="text-properties" style="display: none;">
          <div class="property-group">
            <label>Content</label>
            <textarea id="prop-text-content" placeholder="Text content" rows="3"></textarea>
          </div>
          <div class="property-group">
            <label>Font Size</label>
            <input type="number" id="prop-font-size" value="24" min="8" max="200">
          </div>
          <div class="property-group">
            <label>Font Family</label>
            <select id="prop-font-family">
              <option value="Arial">Arial</option>
              <option value="Times New Roman">Times New Roman</option>
              <option value="Georgia">Georgia</option>
              <option value="Verdana">Verdana</option>
              <option value="Courier New">Courier New</option>
              <option value="serif">Serif</option>
              <option value="sans-serif">Sans-serif</option>
              <option value="monospace">Monospace</option>
            </select>
          </div>
          <div class="property-group">
            <label>Alignment</label>
            <select id="prop-text-anchor">
              <option value="start">Left</option>
              <option value="middle">Center</option>
              <option value="end">Right</option>
            </select>
          </div>
          <div class="property-group">
            <label>Line Height</label>
            <select id="prop-line-height">
              <option value="1">1.0</option>
              <option value="1.2" selected>1.2</option>
              <option value="1.5">1.5</option>
              <option value="2">2.0</option>
            </select>
          </div>
          <div class="property-group">
            <label>Style</label>
            <div class="text-style-buttons">
              <button type="button" id="prop-font-bold-btn" class="style-btn" title="Bold">B</button>
              <button type="button" id="prop-font-italic-btn" class="style-btn" title="Italic"><em>I</em></button>
              <button type="button" id="prop-text-underline-btn" class="style-btn" title="Underline"><u>U</u></button>
              <button type="button" id="prop-text-strikethrough-btn" class="style-btn" title="Strikethrough"><s>S</s></button>
            </div>
          </div>
        </div>

        <div class="property-group">
          <label>Fill</label>
          <div class="color-input-wrapper">
            <input type="color" id="prop-fill" value="#ffffff">
            <label class="checkbox-label">
              <input type="checkbox" id="prop-fill-none">
              None
            </label>
          </div>
        </div>

        <div class="property-group">
          <label>Stroke</label>
          <div class="color-input-wrapper">
            <input type="color" id="prop-stroke" value="#000000">
          </div>
        </div>

        <div class="property-group">
          <label>Stroke Width</label>
          <input type="number" id="prop-stroke-width" value="2" min="0" step="0.5">
        </div>

        <div class="property-group">
          <label>Opacity</label>
          <input type="range" id="prop-opacity" value="100" min="0" max="100">
          <span id="prop-opacity-value">100%</span>
        </div>

        <div class="property-group">
          <label>Stroke Style</label>
          <select id="prop-stroke-dasharray">
            <option value="">Solid</option>
            <option value="5,5">Dashed</option>
            <option value="2,2">Dotted</option>
            <option value="10,5,2,5">Dash-Dot</option>
          </select>
        </div>

        <div class="property-group">
          <label>Line Cap</label>
          <select id="prop-stroke-linecap">
            <option value="butt">Butt</option>
            <option value="round">Round</option>
            <option value="square">Square</option>
          </select>
        </div>

        <!-- Rotation property (hidden by default, shown for rotatable shapes) -->
        <div id="rotation-property" class="property-group" style="display: none;">
          <label>Rotation</label>
          <div class="rotation-input-wrapper">
            <input type="number" id="prop-rotation" value="0" min="0" max="360" step="1">
            <span>°</span>
          </div>
        </div>

        <!-- Node-specific properties (hidden by default) -->
        <div id="node-properties" style="display: none;">
          <div class="property-group">
            <label>Node Label</label>
            <input type="text" id="prop-node-label" placeholder="Label">
          </div>
          <div class="property-group">
            <label>Font Size</label>
            <input type="number" id="prop-node-font-size" value="14" min="8" max="72">
          </div>
        </div>

        <!-- Edge-specific properties (hidden by default) -->
        <div id="edge-properties" style="display: none;">
          <div class="property-group">
            <label>Direction</label>
            <select id="prop-edge-direction">
              <option value="none">Undirected</option>
              <option value="forward">Forward (→)</option>
              <option value="backward">Backward (←)</option>
            </select>
          </div>
          <div class="property-group">
            <label>Edge Label</label>
            <input type="text" id="prop-edge-label" placeholder="Label">
          </div>
        </div>

        <!-- Path-specific properties (hidden by default) -->
        <div id="path-properties" style="display: none;">
          <div class="property-group">
            <label>Path Data (d)</label>
            <textarea id="prop-path-data" placeholder="M 0 0 L 100 100" rows="4" style="font-family: monospace; font-size: 11px;"></textarea>
          </div>
        </div>

        <!-- Marker properties for Line and Path (hidden by default) -->
        <div id="marker-properties" style="display: none;">
          <div class="property-group">
            <label>Arrow Start</label>
            <select id="prop-marker-start">
              <option value="none">None</option>
              <optgroup label="Arrow (>)">
                <option value="arrow-small">Arrow - S</option>
                <option value="arrow-medium">Arrow - M</option>
                <option value="arrow-large">Arrow - L</option>
              </optgroup>
              <optgroup label="Triangle">
                <option value="triangle-small">Triangle - S</option>
                <option value="triangle-medium">Triangle - M</option>
                <option value="triangle-large">Triangle - L</option>
              </optgroup>
              <optgroup label="Circle">
                <option value="circle-small">Circle - S</option>
                <option value="circle-medium">Circle - M</option>
                <option value="circle-large">Circle - L</option>
              </optgroup>
              <optgroup label="Diamond">
                <option value="diamond-small">Diamond - S</option>
                <option value="diamond-medium">Diamond - M</option>
                <option value="diamond-large">Diamond - L</option>
              </optgroup>
            </select>
          </div>
          <div class="property-group">
            <label>Arrow End</label>
            <select id="prop-marker-end">
              <option value="none">None</option>
              <optgroup label="Arrow (>)">
                <option value="arrow-small">Arrow - S</option>
                <option value="arrow-medium">Arrow - M</option>
                <option value="arrow-large">Arrow - L</option>
              </optgroup>
              <optgroup label="Triangle">
                <option value="triangle-small">Triangle - S</option>
                <option value="triangle-medium">Triangle - M</option>
                <option value="triangle-large">Triangle - L</option>
              </optgroup>
              <optgroup label="Circle">
                <option value="circle-small">Circle - S</option>
                <option value="circle-medium">Circle - M</option>
                <option value="circle-large">Circle - L</option>
              </optgroup>
              <optgroup label="Diamond">
                <option value="diamond-small">Diamond - S</option>
                <option value="diamond-medium">Diamond - M</option>
                <option value="diamond-large">Diamond - L</option>
              </optgroup>
            </select>
          </div>
        </div>

        <!-- Canvas Size -->
        <div id="canvas-size-section" class="property-section">
          <label class="section-label">Canvas Size</label>
          <div class="property-row">
            <div class="property-group small">
              <label>W</label>
              <input type="number" id="prop-canvas-width" step="10" min="100">
            </div>
            <div class="property-group small">
              <label>H</label>
              <input type="number" id="prop-canvas-height" step="10" min="100">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Status Bar -->
    <div id="status-bar">
      <span id="status-tool" class="status-item">Select</span>
      <span class="status-separator">|</span>
      <span id="status-position" class="status-item">X: 0, Y: 0</span>
    </div>
  </div>
</body>
</html>
